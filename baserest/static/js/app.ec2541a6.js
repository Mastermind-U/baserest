(function(t){function e(e){for(var r,s,u=e[0],i=e[1],l=e[2],m=0,d=[];m<u.length;m++)s=u[m],n[s]&&d.push(n[s][0]),n[s]=0;for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r]);c&&c(e);while(d.length)d.shift()();return o.push.apply(o,l||[]),a()}function a(){for(var t,e=0;e<o.length;e++){for(var a=o[e],r=!0,u=1;u<a.length;u++){var i=a[u];0!==n[i]&&(r=!1)}r&&(o.splice(e--,1),t=s(s.s=a[0]))}return t}var r={},n={app:0},o=[];function s(e){if(r[e])return r[e].exports;var a=r[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=r,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(a,r,function(e){return t[e]}.bind(null,r));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var u=window["webpackJsonp"]=window["webpackJsonp"]||[],i=u.push.bind(u);u.push=e,u=u.slice();for(var l=0;l<u.length;l++)e(u[l]);var c=i;o.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"4c98":function(t,e,a){"use strict";var r=a("e9e5"),n=a.n(r);n.a},5072:function(t,e,a){"use strict";var r=a("b724"),n=a.n(r);n.a},"56d7":function(t,e,a){"use strict";a.r(e);a("cadf"),a("551c"),a("f751"),a("097d");var r=a("2b0e"),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},o=[],s=a("2877"),u={},i=Object(s["a"])(u,n,o,!1,null,null,null),l=i.exports,c=a("8c4f"),m=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("mu-container",[a("mu-appbar",{attrs:{color:"primary"}},[t._v("\n            Hello! Чат на vue.js!\n            "),t.auth?a("mu-button",{attrs:{slot:"right",flat:""},on:{click:t.logout},slot:"right"},[t._v("Выход")]):a("mu-button",{attrs:{slot:"right",flat:""},on:{click:t.loginRedirect},slot:"right"},[t._v("Вход")])],1),t._t("default")],2)],1)},d=[],p={name:"Home",data:function(){return{dialog:{pk:"",show:!1}}},computed:{auth:function(){if(sessionStorage.getItem("auth_token"))return!0}},methods:{loginRedirect:function(){this.$router.push({name:"login"})},logout:function(){sessionStorage.removeItem("auth_token"),window.location="/"}}},f=p,h=Object(s["a"])(f,m,d,!1,null,"56f6c425",null),v=h.exports,g=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("mu-container",{staticClass:"mt-5",attrs:{align:"center"}},[a("mu-form",{ref:"form",staticClass:"mu-demo-form",attrs:{model:t.validateForm}},[a("mu-form-item",{attrs:{label:"username","help-text":"Введите имя пользователя",prop:"username",rules:t.usernameRules}},[a("mu-text-field",{attrs:{prop:"username"},model:{value:t.validateForm.username,callback:function(e){t.$set(t.validateForm,"username",e)},expression:"validateForm.username"}})],1),a("mu-form-item",{attrs:{label:"password",prop:"password",rules:t.passwordRules}},[a("mu-text-field",{attrs:{type:"password",prop:"password"},model:{value:t.validateForm.password,callback:function(e){t.$set(t.validateForm,"password",e)},expression:"validateForm.password"}})],1),a("mu-form-item",[a("mu-button",{attrs:{color:"primary"},on:{click:t.setlogin}},[t._v("Вход")])],1)],1)],1)],1)},b=[],_={name:"Login",data:function(){return{usernameRules:[{validate:function(t){return!!t},message:"Username must be filled in"},{validate:function(t){return t.length>=3},message:"Username length greater than 3"}],passwordRules:[{validate:function(t){return!!t},message:"Password must be filled in"},{validate:function(t){return t.length>=3&&t.length<=10},message:"Password length must be greater than 3 and less than 10"}],validateForm:{username:"",password:""}}},methods:{setlogin:function(){var t=this;$.ajax({url:"http://185.159.129.154/auth/token/login/",type:"POST",data:{username:this.validateForm.username,password:this.validateForm.password},success:function(e){alert("Вход выполнен"),sessionStorage.setItem("auth_token",e.data.attributes.auth_token),t.$router.push({name:"room"})},error:function(t){400===t.status&&alert("Неверный логин или пароль!"),401===t.status&&alert(t.statusText)}})}}},x=_,w=(a("68e2"),Object(s["a"])(x,g,b,!1,null,"4a7719e4",null)),k=w.exports,y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("RoomSlot",[a("mu-container",[a("AddUsers",{attrs:{room:t.pk}}),a("mu-container",{ref:"container",staticClass:"messages",attrs:{align:"end"}},t._l(t.chats,function(e){return a("div",{key:e},[a("p",[a("strong",[t._v(t._s(e.user.username))])]),a("p",[t._v(t._s(e.text))]),a("span",[t._v(t._s(e.date))]),a("mu-divider")],1)}),0),a("mu-container",{staticClass:"text"},[a("mu-text-field",{staticClass:"textbase",attrs:{"multi-line":"",prop:"model",rows:4,"rows-max":6,placeholder:"Введите текст сообщения"},model:{value:t.form.textarea,callback:function(e){t.$set(t.form,"textarea",e)},expression:"form.textarea"}}),a("mu-button",{attrs:{color:"blue"},on:{click:t.sendMessage}},[t._v("Send"),a("mu-icon",{attrs:{right:"",value:"send"}})],1)],1)],1)],1)},j=[],S=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("HomeSlot",[a("mu-row",{attrs:{gutter:""}},[a("mu-col",{attrs:{span:"2"}},[a("mu-paper",{staticStyle:{border:".5px solid black"},attrs:{"z-depth":1}},[a("mu-list",{attrs:{textline:"two-line","z-depth":1}},t._l(t.rooms,function(e){return a("div",{key:e},[a("div",{on:{click:function(a){return t.openChat(e.pk)}}},[a("mu-list-item",{attrs:{button:"",ripple:!1}},[a("mu-list-item-content",[a("mu-list-item-title",[a("h4",[t._v(t._s(e.creator.username))])]),a("mu-list-item-sub-title",[t._v(t._s(e.date))])],1)],1)],1)])}),0)],1),a("mu-button",{staticClass:"addbtn",on:{click:t.addRoom}},[t._v("Add Room")])],1),a("mu-col",{attrs:{span:"10"}},[t._t("default")],2)],1)],1)},O=[],T={name:"Room",components:{HomeSlot:v},data:function(){return{rooms:""}},created:function(){$.ajaxSetup({headers:{Authorization:"Token "+sessionStorage.getItem("auth_token")}}),this.loadRoom()},methods:{loadRoom:function(){var t=this;$.ajax({url:"http://185.159.129.154/api/v1/chat/room/",type:"GET",success:function(e){t.rooms=e.data.data}})},openChat:function(t){this.$router.push({name:"chat",params:{pk:t}})},addRoom:function(){var t=this;$.ajax({url:"http://185.159.129.154/api/v1/chat/room/",type:"POST",success:function(e){t.loadRoom()},error:function(t){alert(t.statusText)}})}}},R=T,C=(a("5072"),Object(s["a"])(R,S,O,!1,null,"ae66acc2",null)),P=C.exports,E=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{align:"center"}},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.option,expression:"option"}],on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.option=e.target.multiple?a:a[0]}}},t._l(t.list,function(e){return a("option",{key:e.id,domProps:{value:e.id}},[t._v("\n            "+t._s(e.attributes.username)+"\n        ")])}),0),a("mu-button",{on:{click:t.addUser}},[t._v("Add")])],1)},F=[],U={name:"AddUsers",props:{room:""},data:function(){return{option:"",list:""}},created:function(){this.loadUsers()},methods:{loadUsers:function(){var t=this;$.ajax({url:"http://185.159.129.154/api/v1/chat/users/",type:"GET",success:function(e){t.list=e.data}})},addUser:function(){$.ajax({url:"http://185.159.129.154/api/v1/chat/users/",type:"GET",data:{room:this.room,user:parseInt(this.option)},success:function(t){alert("Пользователь добавлен!")},error:function(t){alert("Ошибка!")}})}}},A=U,I=Object(s["a"])(A,E,F,!1,null,"023b5362",null),M=I.exports,z={name:"Chat",props:{pk:""},components:{AddUsers:M,RoomSlot:P},data:function(){return{chats:"",form:{textarea:""}}},created:function(){var t=this;$.ajaxSetup({headers:{Authorization:"Token "+sessionStorage.getItem("auth_token")}}),this.loadChat(),setInterval(function(){t.loadChat()},2e3)},methods:{loadChat:function(){var t=this;$.ajax({url:"http://185.159.129.154/api/v1/chat/chat/",type:"GET",data:{room:this.$route.params.pk},success:function(e){t.chats=e.data.data}})},sendMessage:function(){var t=this;$.ajax({url:"http://185.159.129.154/api/v1/chat/chat/",type:"POST",data:{room:this.$route.params.pk,text:this.form.textarea},success:function(e){t.loadChat(),t.form.textarea=""},error:function(t){alert(t.statusText)}})}}},G=z,H=(a("4c98"),Object(s["a"])(G,y,j,!1,null,"f2f6e818",null)),J=H.exports;r["a"].use(c["a"]);var L=new c["a"]({mode:"history",routes:[{path:"/",name:"room",component:P},{path:"/login/",name:"login",component:k},{path:"/chat/:pk",name:"chat",component:J}]}),N=a("30f4");a("d6f6"),a("ab8b"),a("4989"),a("c789");window.$=window.jQuery=a("1157"),r["a"].use(N["a"]),r["a"].config.productionTip=!1,r["a"].config.productionTip=!1,new r["a"]({router:L,render:function(t){return t(l)}}).$mount("#app")},"68e2":function(t,e,a){"use strict";var r=a("d90c"),n=a.n(r);n.a},b724:function(t,e,a){},d90c:function(t,e,a){},e9e5:function(t,e,a){}});
//# sourceMappingURL=app.ec2541a6.js.map